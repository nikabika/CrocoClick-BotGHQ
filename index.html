<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ì–∞–ª–µ—Ä–µ—è —Å–æ —Å–≤–∞–π–ø–∞–º–∏</title>
    <link href="https://fonts.googleapis.com/css2?family=Avenir+Next:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Avenir Next', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: #1C1C1E;
            color: #FFFFFF;
            min-height: 100vh;
            overflow: hidden;
            touch-action: none;
            position: relative;
        }
        
        /* –ê–≤–∞—Ç–∞—Ä–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è */
        .user-avatar {
            position: fixed;
            top: 20px;
            left: 20px;
            width: 50px;
            height: 50px;
            border-radius: 16px;
            overflow: hidden;
            z-index: 100;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }
        
        .user-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .user-avatar-placeholder {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-weight: 600;
            font-size: 20px;
        }
        
        .gallery-container {
            width: 100%;
            max-width: 100%;
            height: 40vh;
            position: fixed;
            top: 75px;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10;
        }
        
        .cards-wrapper {
            position: relative;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .card {
            position: absolute;
            transition: all 0.4s cubic-bezier(0.23, 1, 0.32, 1);
            border-radius: 16px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4);
            overflow: hidden;
            cursor: pointer;
        }
        
        .card img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
        }
        
        .center {
            width: 200px;
            height: 280px;
            z-index: 30;
            opacity: 1;
            transform: translateX(0) scale(1);
        }
        
        .right {
            width: 140px;
            height: 200px;
            z-index: 20;
            opacity: 0.7;
            transform: translateX(180px) scale(0.8);
        }
        
        .left {
            width: 140px;
            height: 200px;
            z-index: 20;
            opacity: 0.7;
            transform: translateX(-180px) scale(0.8);
        }

        .hidden {
            opacity: 0;
            pointer-events: none;
            z-index: 5;
            transition: none;
        }

        /* –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è –ø–∞–Ω–µ–ª—å */
        .info-panel {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: 50vh;
            background-color: #1C1C1E;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            padding-top: 20px;
        }
        
        .info-box {
            width: 320px;
            height: 240px;
            background-color: #171717;
            border-radius: 16px;
            display: flex;
            flex-direction: column;
            padding: 24px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }
        
        .info-title {
            font-family: 'Avenir Next', sans-serif;
            font-size: 22px;
            font-weight: 700;
            color: #FFFFFF;
            margin-bottom: 24px;
            text-align: center;
            letter-spacing: 0.5px;
        }
        
        .info-content {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }
        
        .characteristic-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 4px 0;
        }
        
        .characteristic-label {
            font-size: 14px;
            font-weight: 500;
            color: rgba(255, 255, 255, 0.7);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .characteristic-value {
            font-size: 16px;
            font-weight: 600;
            text-align: right;
        }
        
        /* –¶–≤–µ—Ç–∞ —Ä–µ–¥–∫–æ—Å—Ç–µ–π */
        .common { color: #4CAF50; } /* –ó–µ–ª–µ–Ω—ã–π */
        .uncommon { color: #2196F3; } /* –°–∏–Ω–∏–π */
        .epic { color: #9C27B0; } /* –§–∏–æ–ª–µ—Ç–æ–≤—ã–π */
        .mythic { color: #FFD700; } /* –ó–æ–ª–æ—Ç–æ–π */

        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö */
        @media (max-width: 480px) {
            .user-avatar {
                top: 15px;
                left: 15px;
                width: 45px;
                height: 45px;
            }
            
            .gallery-container {
                height: 35vh;
                top: 60px;
            }
            
            .center {
                width: 180px;
                height: 250px;
            }
            
            .right, .left {
                width: 120px;
                height: 170px;
                transform: translateX(150px) scale(0.8);
            }
            
            .right {
                transform: translateX(150px) scale(0.8);
            }
            
            .left {
                transform: translateX(-150px) scale(0.8);
            }
            
            .info-box {
                width: 280px;
                height: 220px;
                padding: 20px;
            }
            
            .info-title {
                font-size: 20px;
            }
            
            .characteristic-value {
                font-size: 15px;
            }
        }

        @media (max-width: 380px) {
            .user-avatar {
                top: 12px;
                left: 12px;
                width: 40px;
                height: 40px;
            }
            
            .gallery-container {
                top: 50px;
            }
            
            .center {
                width: 160px;
                height: 220px;
            }
            
            .right, .left {
                width: 110px;
                height: 150px;
                transform: translateX(130px) scale(0.8);
            }
            
            .right {
                transform: translateX(130px) scale(0.8);
            }
            
            .left {
                transform: translateX(-130px) scale(0.8);
            }
            
            .info-box {
                width: 250px;
                height: 200px;
                padding: 16px;
            }
            
            .info-title {
                font-size: 18px;
                margin-bottom: 20px;
            }
            
            .characteristic-label {
                font-size: 13px;
            }
            
            .characteristic-value {
                font-size: 14px;
            }
            
            .info-content {
                gap: 14px;
            }
        }

        @media (max-width: 320px) {
            .user-avatar {
                top: 10px;
                left: 10px;
                width: 35px;
                height: 35px;
                border-radius: 12px;
            }
            
            .gallery-container {
                top: 40px;
            }
            
            .right, .left {
                transform: translateX(110px) scale(0.8);
            }
            
            .right {
                transform: translateX(110px) scale(0.8);
            }
            
            .left {
                transform: translateX(-110px) scale(0.8);
            }
            
            .info-box {
                width: 220px;
                height: 190px;
                padding: 14px;
            }
            
            .info-title {
                font-size: 17px;
                margin-bottom: 18px;
            }
            
            .characteristic-label {
                font-size: 12px;
            }
            
            .characteristic-value {
                font-size: 13px;
            }
            
            .info-content {
                gap: 12px;
            }
        }

        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            color: rgba(255, 255, 255, 0.7);
            font-size: 16px;
            font-family: 'Avenir Next', sans-serif;
        }
    </style>
</head>
<body>
    <!-- –ê–≤–∞—Ç–∞—Ä–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
    <div class="user-avatar" id="user-avatar">
        <div class="user-avatar-placeholder">üë§</div>
    </div>

    <div class="gallery-container" id="gallery-container">
        <div class="cards-wrapper" id="cards-wrapper">
            <div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞—Ä—Ç–∏–Ω–æ–∫...</div>
        </div>
    </div>

    <div class="info-panel">
        <div class="info-box">
            <div class="info-title" id="card-title">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
            <div class="info-content">
                <div class="characteristic-row">
                    <span class="characteristic-label">–†–µ–¥–∫–æ—Å—Ç—å</span>
                    <span class="characteristic-value" id="rarity">‚Äî</span>
                </div>
                <div class="characteristic-row">
                    <span class="characteristic-label">–ü–∞—Ç—Ç–µ—Ä–Ω</span>
                    <span class="characteristic-value" id="pattern">‚Äî</span>
                </div>
                <div class="characteristic-row">
                    <span class="characteristic-label">–ö–ª–∞—Å—Å</span>
                    <span class="characteristic-value" id="class">‚Äî</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const gallery = document.getElementById('gallery-container');
            const cardsWrapper = document.getElementById('cards-wrapper');
            const cardTitle = document.getElementById('card-title');
            const raritySpan = document.getElementById('rarity');
            const patternSpan = document.getElementById('pattern');
            const classSpan = document.getElementById('class');
            const userAvatar = document.getElementById('user-avatar');
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram WebApp
            function initTelegramWebApp() {
                try {
                    if (window.Telegram && Telegram.WebApp) {
                        const webApp = Telegram.WebApp;
                        
                        // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                        const user = webApp.initDataUnsafe.user;
                        
                        if (user && user.photo_url) {
                            // –°–æ–∑–¥–∞–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è –∞–≤–∞—Ç–∞—Ä–∫–∏
                            const img = document.createElement('img');
                            img.src = user.photo_url;
                            img.alt = '–ê–≤–∞—Ç–∞—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è';
                            img.onload = function() {
                                userAvatar.innerHTML = '';
                                userAvatar.appendChild(img);
                            };
                            img.onerror = function() {
                                // –ï—Å–ª–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª–æ—Å—å, –æ—Å—Ç–∞–≤–ª—è–µ–º placeholder
                                userAvatar.innerHTML = '<div class="user-avatar-placeholder">üë§</div>';
                            };
                        }
                        
                        // –†–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ –≤–µ—Å—å —ç–∫—Ä–∞–Ω
                        webApp.expand();
                        webApp.enableClosingConfirmation();
                        
                        console.log('Telegram WebApp –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
                    } else {
                        console.log('Telegram WebApp –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ–º placeholder');
                    }
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ Telegram WebApp:', error);
                }
            }
            
            // –î–∞–Ω–Ω—ã–µ –∫–∞—Ä—Ç–æ—á–µ–∫
            const cardData = [
                {
                    url: "https://cdn.qwenlm.ai/72327e40-02c9-46e7-a011-0542655a56ad/2e7c07e8-2adf-45af-9228-84d5c942dd29_%D0%A8%D0%A2%D0%A3%D0%A0%D0%9C%D0%9E%D0%92%D0%98%D0%9A_.png?key=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJyZXNvdXJjZV91c2VyX2lkIjoiNzIzMjdlNDAtMDJjOS00NmU3LWEwMTEtMDU0MjY1NWE1NmFkIwiLCJyZXNvdXJjZV9jaGF0X2lkIjpudWxsfQ.n2ib1vj1Pke2VoDdWfMQfZWDG5XRih8WwowNRV6oyoA&x-oss-process=image/resize,m_mfit,w_320,h_320",
                    name: "–®—Ç—É—Ä–º–æ–≤–∏–∫",
                    rarity: "–û–±—ã—á–Ω–∞—è",
                    rarityClass: "common",
                    faction: "–ò–º–ø–µ—Ä–∏—è"
                },
                {
                    url: "https://cdn.qwenlm.ai/72327e40-02c9-46e7-a011-0542655a56ad/7c399af7-1a69-4c00-996f-ca8438a8747c_%D0%91%D0%9E%D0%91%D0%90_%D0%A4%D0%95%D0%A2%D0%A2.png?key=eyJhbGciOiJIUzI1NiIsÊûÅ5cCI6IkpXVCJ9.eyJyZXNvdXJjZV91c2VyX2lkIjoiNzIzMjdlNDAtMDJjOS00NmU3LWEwMTEtMDU0MjY1NWE1NmFkIiwicmVzb3VyY2VfaWQiOiI3YzM5OWFmNy0xYTY5LTRjMDAtOTk2Zi1jYTg0MzhhODc0N2MiLCJyZXNvdXJjZV9jaGF0X2lkIjpudWxsfQ.8q-1PBMMKdPT9bpmh0k2IAOtyelpvjMnoL1aXgioGyo&x-oss-process=image/resize,m_mfit,w_320,h_320",
                    name: "–ë–æ–±–∞ –§–µ—Ç—Ç",
                    rarity: "–≠–ø–∏–∫",
                    rarityClass: "epic",
                    faction: "–ù–∞–µ–º–Ω–∏–∫–∏"
                },
                {
                    url: "https://cdn.qwenlm.ai/72327e40-02c9-46e7-a011-0542655a56ad/ab2095a2-225f-4b0c-b0de-7af788f64043_%D0%AD%D0%98%CC%86%D0%9B%D0%90_%D0%A1%D0%95%D0%9A%D0%A3%D0%A0%D0%90.png?key=eyJhbGciOiJIUzI1NiIsÊûÅ5cCI6IkpXVCJ9.eyJyZXNvdXJjZV91c2VyX2lkIjoiNzIzMjdlNDAtMDJjOS00NmU3LWEwMTEtMDU0MjY1NWE1NmFkIiwicmVzb3VyY2VfaWQiOiJhYjIwOTVhMi0yMjVmLTRiMGMtYjBkZS03YWY3ODhmNjQwNDMiLCJyZXNvdXJjZV9jaGF0X2lkIjpnuWxsfQ.UgjRr7ÊûÅVEjLDIisj1OLpONACN7AmNQgtkW5WalADHOg&x-oss-process=image/resize,mÊûÅfit,w_320,h_320",
                    name: "–≠–π–ª–∞ –°–µ–∫—É—Ä–∞",
                    rarity: "–≠–ø–∏–∫",
                    rarityClass: "epic",
                    faction: "–†–µ—Å–ø—É–±–ª–∏–∫–∞"
                }
            ];

            let cards = [];
            let currentCenterIndex = 0;
            let startX = 0;
            let currentX = 0;
            let isDragging = false;

            // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω–æ–≥–æ –ø–∞—Ç—Ç–µ—Ä–Ω–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–µ–¥–∫–æ—Å—Ç–∏
            function generatePattern(rarity) {
                let min, max;
                
                if (rarity === "–≠–ø–∏–∫") {
                    min = 15;
                    max = 45;
                } else if (rarity === "–ù–µ–æ–±—ã—á–Ω–∞—è") {
                    min = 30;
                    max = 70;
                } else {
                    min = 50;
                    max = 100;
                }
                
                const pattern = Math.floor(Math.random() * (max - min + 1)) + min;
                return `${pattern}%`;
            }

            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∫–∞—Ä—Ç–æ—á–∫–µ
            function updateCardInfo() {
                const currentCard = cardData[currentCenterIndex];
                cardTitle.textContent = currentCard.name;
                raritySpan.textContent = currentCard.rarity;
                raritySpan.className = `characteristic-value ${currentCard.rarityClass}`;
                patternSpan.textContent = generatePattern(currentCard.rarity);
                classSpan.textContent = currentCard.faction;
            }

            // –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–µ–∫
            function createCards() {
                cardsWrapper.innerHTML = '';
                cards = [];
                
                // –°–æ–∑–¥–∞–µ–º 3 –∫–∞—Ä—Ç–æ—á–∫–∏
                for (let i = 0; i < 3; i++) {
                    const card = document.createElement('div');
                    card.className = 'card hidden';
                    card.id = `card-${i}`;
                    
                    const img = document.createElement('img');
                    img.src = cardData[i].url;
                    img.alt = cardData[i].name;
                    img.onerror = function() {
                        this.style.backgroundColor = '#48484A';
                        this.style.display = 'flex';
                        this.style.justifyContent = 'center';
                        this.style.alignItems = 'center';
                        this.style.color = 'white';
                        this.style.fontFamily = 'Avenir Next, sans-serif';
                        this.innerHTML = '–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏';
                    };
                    
                    card.appendChild(img);
                    cardsWrapper.appendChild(card);
                    cards.push(card);
                }
                
                updateCardsPosition();
                updateCardInfo();
            }

            function updateCardsPosition() {
                cards.forEach((card, index) => {
                    card.className = 'card hidden';
                    
                    if (index === currentCenterIndex) {
                        card.className = 'card center';
                    } else if (index === currentCenterIndex + 1) {
                        card.className = 'card right';
                    } else if (index === currentCenterIndex - 1) {
                        card.className = 'card left';
                    }
                });
            }
            
            function nextCard() {
                if (currentCenterIndex < cards.length - 1) {
                    currentCenterIndex++;
                    updateCardsPosition();
                    updateCardInfo();
                }
            }
            
            function prevCard() {
                if (currentCenterIndex > 0) {
                    currentCenterIndex--;
                    updateCardsPosition();
                    updateCardInfo();
                }
            }
            
            function setupEventListeners() {
                gallery.addEventListener('mousedown', function(e) {
                    isDragging = true;
                    startX = e.clientX;
                    currentX = startX;
                });
                
                gallery.addEventListener('mousemove', function(e) {
                    if (!isDragging) return;
                    currentX = e.clientX;
                });
                
                gallery.addEventListener('mouseup', function() {
                    if (!isDragging) return;
                    isDragging = false;
                    
                    const diff = startX - currentX;
                    if (Math.abs(diff) > 50) {
                        if (diff > 0) {
                            nextCard();
                        } else {
                            prevCard();
                        }
                    }
                });
                
                gallery.addEventListener('mouseleave', function() {
                    isDragging = false;
                });
                
                gallery.addEventListener('touchstart', function(e) {
                    isDragging = true;
                    startX = e.touches[0].clientX;
                    currentX = startX;
                }, { passive: true });
                
                gallery.addEventListener('touchmove', function(e) {
                    if (!isDragging) return;
                    currentX = e.touches[0].clientX;
                }, { passive: true });
                
                gallery.addEventListener('touchend', function() {
                    if (!isDragging) return;
                    isDragging = false;
                    
                    const diff = startX - currentX;
                    if (Math.abs(diff) > 30) {
                        if (diff > 0) {
                            nextCard();
                        } else {
                            prevCard();
                        }
                    }
                }, { passive: true });
            }

            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
            initTelegramWebApp();
            createCards();
            setupEventListeners();
        });
    </script>
</body>
</html>
