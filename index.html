<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–ü—Ä–æ—Ñ–∏–ª—å - Telegram Mini App</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            -webkit-tap-highlight-color: transparent;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            -webkit-touch-callout: none;
        }

        body {
            background-color: #121212;
            color: #FFFFFF;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            touch-action: manipulation;
        }

        .back-button {
            position: absolute;
            top: 20px;
            left: 20px;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: #2C2C2E;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 10;
            transition: transform 0.1s ease;
        }

        .back-button:active {
            transform: scale(0.95);
        }

        .back-icon {
            width: 24px;
            height: 24px;
            color: white;
        }

        .avatar-container {
            width: 120px;
            height: 120px;
            border-radius: 17px;
            background-color: #2C2C2E;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-top: 40px;
            margin-bottom: 20px;
            overflow: hidden;
        }

        .avatar-placeholder {
            width: 60px;
            height: 60px;
            background-color: #8E8E93;
            border-radius: 50%;
        }

        .user-avatar {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: none;
        }

        .username {
            font-size: 24px;
            font-weight: 700;
            text-align: center;
            margin-bottom: 5px;
        }

        .user-tag {
            font-size: 16px;
            color: rgba(255, 255, 255, 0.7);
            text-align: center;
            margin-bottom: 30px;
        }

        .settings-container {
            width: 100%;
            max-width: 400px;
        }

        .setting-item {
            background-color: #2C2C2E;
            border-radius: 17px;
            padding: 16px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            transition: transform 0.1s ease;
        }

        .setting-item:active {
            transform: scale(0.98);
        }

        .setting-content {
            display: flex;
            align-items: center;
            flex: 1;
        }

        .setting-emoji {
            font-size: 28px;
            margin-right: 15px;
        }

        .setting-text {
            display: flex;
            flex-direction: column;
        }

        .setting-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .setting-description {
            font-size: 13px;
            color: rgba(255, 255, 255, 0.6);
            line-height: 1.3;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—è */
        .switch {
            position: relative;
            display: inline-block;
            width: 51px;
            height: 31px;
            flex-shrink: 0;
            margin-left: 15px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(255, 255, 255, 0.2);
            transition: .3s;
            border-radius: 34px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 27px;
            width: 27px;
            left: 2px;
            bottom: 2px;
            background-color: white;
            transition: .3s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: #40a7e3;
        }

        input:checked + .slider:before {
            transform: translateX(20px);
        }

        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 400px) {
            .avatar-container {
                width: 100px;
                height: 100px;
            }
            
            .username {
                font-size: 20px;
            }
            
            .user-tag {
                font-size: 14px;
            }
        }
    </style>
</head>
<body>
    <div class="back-button" id="back-button">
        <svg class="back-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M15 6l-6 6l6 6" />
        </svg>
    </div>

    <div class="avatar-container">
        <div class="avatar-placeholder" id="avatar-placeholder"></div>
        <img class="user-avatar" id="user-avatar" src="" alt="–ê–≤–∞—Ç–∞—Ä">
    </div>

    <div class="username" id="username">–ò–º—è</div>
    <div class="user-tag" id="user-tag">@username</div>

    <div class="settings-container">
        <div class="setting-item">
            <div class="setting-content">
                <div class="setting-emoji">üêä</div>
                <div class="setting-text">
                    <div class="setting-title">–ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏–∫–æ–Ω–∫–∏</div>
                    <div class="setting-description">–ò–∫–æ–Ω–∫–∏ –±–∞–Ω–Ω–µ—Ä–æ–≤ —Å—Ç–∞–Ω—É—Ç –∞–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏. –ù–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Å–ª–∞–±—ã–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º</div>
                </div>
            </div>
            <label class="switch">
                <input type="checkbox" id="animated-icons">
                <span class="slider"></span>
            </label>
        </div>
        
        <div class="setting-item">
            <div class="setting-content">
                <div class="setting-emoji">üéÅ</div>
                <div class="setting-text">
                    <div class="setting-title">–ë–∞–Ω–Ω–µ—Ä—ã —Ä–æ–∑—ã–≥—Ä—ã—à–µ–π</div>
                    <div class="setting-description">–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –¥–µ–π—Å—Ç–≤—É—é—â–∏—Ö —Ä–æ–∑—ã–≥—Ä—ã—à–∞—Ö</div>
                </div>
            </div>
            <label class="switch">
                <input type="checkbox" id="giveaway-banners">
                <span class="slider"></span>
            </label>
        </div>
    </div>

    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram WebApp
        let tg = window.Telegram?.WebApp;
        
        // –≠–ª–µ–º–µ–Ω—Ç—ã DOM
        const backButton = document.getElementById('back-button');
        const usernameElement = document.getElementById('username');
        const userTagElement = document.getElementById('user-tag');
        const avatarElement = document.getElementById('user-avatar');
        const avatarPlaceholder = document.getElementById('avatar-placeholder');
        const animatedIconsSwitch = document.getElementById('animated-icons');
        const giveawayBannersSwitch = document.getElementById('giveaway-banners');
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ª–µ–≥–∫–æ–π –≤–∏–±—Ä–∞—Ü–∏–∏
        function vibrate() {
            if (navigator.vibrate) {
                navigator.vibrate(1);
            } else if (window.Telegram?.WebApp?.HapticFeedback) {
                tg.HapticFeedback.impactOccurred('light');
            }
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ü–≤–µ—Ç–∞ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª–µ–π
        function setSwitchColor() {
            if (tg && tg.themeParams.button_color) {
                document.documentElement.style.setProperty('--accent-color', tg.themeParams.button_color);
                
                // –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç–∏–ª–∏ –¥–ª—è –∞–∫—Ü–µ–Ω—Ç–Ω–æ–≥–æ —Ü–≤–µ—Ç–∞
                const style = document.createElement('style');
                style.textContent = `
                    input:checked + .slider {
                        background-color: ${tg.themeParams.button_color} !important;
                    }
                `;
                document.head.appendChild(style);
            }
        }
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –ø–æ –∫–Ω–æ–ø–∫–µ "–ù–∞–∑–∞–¥"
        backButton.addEventListener('click', () => {
            vibrate();
            // –ó–∞–∫—Ä—ã–≤–∞–µ–º —Ç–µ–∫—É—â–µ–µ –æ–∫–Ω–æ (–≤–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –Ω–∞–∑–∞–¥)
            if (tg && tg.close) {
                tg.close();
            } else {
                // –î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤–Ω–µ Telegram
                window.history.back();
            }
        });
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª–µ–π
        animatedIconsSwitch.addEventListener('change', () => {
            vibrate();
            // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
            console.log('–ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏–∫–æ–Ω–∫–∏:', animatedIconsSwitch.checked);
        });
        
        giveawayBannersSwitch.addEventListener('change', () => {
            vibrate();
            // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
            console.log('–ë–∞–Ω–Ω–µ—Ä—ã —Ä–æ–∑—ã–≥—Ä—ã—à–µ–π:', giveawayBannersSwitch.checked);
        });
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º –¥–ª—è –≤–∏–±—Ä–∞—Ü–∏–∏
        document.querySelectorAll('.setting-item').forEach(item => {
            item.addEventListener('click', (e) => {
                // –í–∏–±—Ä–∞—Ü–∏—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –∫–ª–∏–∫–Ω—É–ª–∏ –Ω–µ –ø–æ —Å–∞–º–æ–º—É –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—é
                if (!e.target.closest('.switch')) {
                    vibrate();
                }
            });
        });
        
        // –ó–∞–ø—Ä–µ—Ç –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –≤—ã–¥–µ–ª–µ–Ω–∏—è
        document.addEventListener('contextmenu', e => e.preventDefault());
        document.addEventListener('selectstart', e => e.preventDefault());
        document.addEventListener('dragstart', e => e.preventDefault());
        
        // –û—Ç–∫–ª—é—á–∞–µ–º –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –∂–µ—Å—Ç–æ–º –¥–≤–æ–π–Ω–æ–≥–æ —Ç–∞–ø–∞
        let lastTouchEnd = 0;
        document.addEventListener('touchend', function (event) {
            const now = (new Date()).getTime();
            if (now - lastTouchEnd <= 300) {
                event.preventDefault();
            }
            lastTouchEnd = now;
        }, false);
        
        if (tg) {
            // –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            const user = tg.initDataUnsafe?.user;
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ —Å –¥–∞–Ω–Ω—ã–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            if (user) {
                if (user.first_name) {
                    usernameElement.textContent = user.first_name;
                }
                
                if (user.username) {
                    userTagElement.textContent = `@${user.username}`;
                } else {
                    userTagElement.style.display = 'none';
                }
                
                // –ó–∞–≥—Ä—É–∑–∫–∞ –∞–≤–∞—Ç–∞—Ä–∫–∏, –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–∞
                if (user.photo_url) {
                    avatarElement.src = user.photo_url;
                    avatarElement.style.display = 'block';
                    avatarPlaceholder.style.display = 'none';
                }
            }
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ü–≤–µ—Ç –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª–µ–π –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –∞–∫—Ü–µ–Ω—Ç–Ω—ã–º —Ü–≤–µ—Ç–æ–º Telegram
            setSwitchColor();
            
            console.log('Telegram WebApp initialized:', tg);
            console.log('User data:', user);
        } else {
            console.log('Not in Telegram environment - using mock data');
            // –ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤–Ω–µ Telegram
            usernameElement.textContent = '–¢–µ—Å—Ç–æ–≤—ã–π –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å';
            userTagElement.textContent = '@testuser';
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ü–≤–µ—Ç –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª–µ–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
            setSwitchColor();
        }
    </script>
</body>
</html>
